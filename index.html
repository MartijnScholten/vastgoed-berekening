<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vastgoed Calculator - Groeitab</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Reset en basis stijlen */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
            color: #333;
        }

        /* Algemene container stijlen met browser compatibiliteit */
        .container {
            
            margin: 0 auto;
            padding: 20px;
        }

        /* Card stijlen met cross-browser shadows */
        .card {
            background-color: #fff;
            border-radius: 8px;
            -webkit-box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
            padding: 24px;
        }

        /* Titel stijlen */
        h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #2d3748;
        }

        h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #4a5568;
        }

        /* Formulier elementen */
        .form-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 16px;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="number"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: #4299e1;
            -webkit-box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }

        /* Checkbox styling met browser compatibility */
        .checkbox-container {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            margin-bottom: 12px;
        }

        .checkbox-container input[type="checkbox"] {
            margin-right: 8px;
        }

        /* Grid systeem met fallbacks */
        .grid {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            margin: -12px;
        }

        .grid-col-1,
        .grid-col-2,
        .grid-col-3 {
            padding: 12px;
            width: 100%;
        }

        /* Responsive grid */
        @media (min-width: 768px) {
            .grid-col-2 {
                width: 50%;
            }

            .grid-col-3 {
                width: 33.333%;
            }
        }

        /* Tabel styling */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th,
        td {
            padding: 12px;
            text-align: left;
            border: 1px solid #e2e8f0;
        }

        th {
            background-color: #f7fafc;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f9fafb;
        }

        /* Kleur categorieën voor rendementen */
        .bg-red-800 {
            background-color: #9b2c2c;
            color: white;
        }

        .bg-red-500 {
            background-color: #f56565;
            color: white;
        }

        .bg-yellow-400 {
            background-color: #f6e05e;
        }

        .bg-green-500 {
            background-color: #48bb78;
            color: white;
        }

        .bg-blue-600 {
            background-color: #3182ce;
            color: white;
        }

        /* Grafiek container */
        .chart-container {
            height: 400px;
            margin-top: 24px;
            margin-bottom: 24px;
            position: relative;
        }

        /* Legenda styling */
        .legenda {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            margin-top: 16px;
            gap: 16px;
        }

        .legenda-item {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            margin-right: 16px;
        }

        .legenda-kleur {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border-radius: 2px;
        }

        /* Formule sectie styling */
        .formules-sectie {
            background-color: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 24px;
        }

        .formule-item {
            margin-bottom: 12px;
        }

        .formule-naam {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .formule-beschrijving {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .formule-code {
            background-color: #edf2f7;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .resultaat-blok {
            background-color: #edf2f7;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
        }

        .resultaat-rij {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: justify;
            -ms-flex-pack: justify;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .resultaat-label {
            font-weight: 500;
        }

        .highlight {
            background-color: #ebf8ff;
            padding: 2px 4px;
            border-radius: 2px;
        }

        /* Knoppen styling */
        .button {
            display: inline-block;
            background-color: #4299e1;
            color: white;
            padding: 10px 16px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            -webkit-transition: background-color 0.2s;
            transition: background-color 0.2s;
        }

        .button:hover {
            background-color: #3182ce;
        }

        .button-secondary {
            background-color: #e2e8f0;
            color: #4a5568;
        }

        .button-secondary:hover {
            background-color: #cbd5e0;
        }

        /* Voeg deze stijlen toe aan de bestaande CSS */
        .settings-section {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .settings-section h3 {
            margin-bottom: 16px;
            color: #2d3748;
            font-size: 18px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .chart-container {
            height: 400px;
            margin: 24px 0;
            position: relative;
        }

        .legenda {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 16px;
        }

        .legenda-item {
            display: flex;
            align-items: center;
            background-color: #f8fafc;
            padding: 8px 12px;
            border-radius: 4px;
        }

        .legenda-kleur {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border-radius: 2px;
        }

        /* Voeg deze stijlen toe aan de bestaande CSS */
        .tab-navigation {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background-color: #e2e8f0;
            color: #4a5568;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tab-button.active {
            background-color: #4299e1;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Voeg deze stijlen toe aan de bestaande CSS */
        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 24px;
        }

        .settings-panel {
            position: sticky;
            top: 24px;
            height: fit-content;
        }

        .results-panel {
            min-width: 0; /* Voorkomt overflow problemen */
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .chart-container {
            height: 400px;
            position: relative;
        }

        /* Voeg deze stijlen toe aan de bestaande CSS */
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
            margin: 10px 0;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
            border: none;
        }

        .comfort-niveaus {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin: 24px 0;
        }

        .comfort-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .comfort-item {
            background-color: white;
            padding: 12px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .comfort-label {
            font-weight: 500;
            color: #4a5568;
        }

        .comfort-item span:last-child {
            display: block;
            margin-top: 4px;
            font-size: 1.1em;
            color: #2d3748;
        }

        /* Verbeterde tabel styling voor vermogensgroei */
        .table-container table th,
        .table-container table td {
            white-space: nowrap;
            padding: 8px 12px;
        }

        .table-container table th {
            position: sticky;
            top: 0;
            background-color: #f7fafc;
            z-index: 1;
        }

        /* Verbeterde grafiek styling */
        .chart-container {
            background-color: white;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Responsive aanpassingen */
        @media (max-width: 768px) {
            .comfort-grid {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <!-- Tab navigatie -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="scenario">Scenario Analyse</button>
            <button class="tab-button" data-tab="groeiprojectie">Groeiprojectie</button>
            <button class="tab-button" data-tab="vermogensdoel">Vermogensdoel</button>
            <button class="tab-button" data-tab="vermogensgroei">Vermogensgroei & Inkomen</button>
        </div>

        <!-- Scenario Tab content -->
        <div id="scenarioTab" class="tab-content active">
            <div class="main-layout">
                <!-- Instellingen Panel -->
                <div class="settings-panel">
            <div class="card">
                        <h2>Instellingen</h2>

                        <!-- Basis Instellingen -->
                        <div class="settings-section">
                            <h3>Basis Instellingen</h3>
                <div class="grid">
                                <div class="grid-col-1">
                        <div class="form-group">
                            <label for="eigenVermogen">Eigen vermogen (€):</label>
                            <input type="number" id="eigenVermogen" value="500000" step="10000">
                        </div>

                        <div class="form-group">
                            <label for="ltv">Loan-to-Value (%):</label>
                            <input type="number" id="ltv" value="75" min="0" max="100">
                        </div>

                        <div class="form-group">
                            <label for="rentePercentage">Hypotheekrente (%):</label>
                            <input type="number" id="rentePercentage" value="5" step="0.1" min="0">
                        </div>

                                    <div class="form-group">
                                        <label for="structuur">Structuur:</label>
                                        <select id="structuur" class="form-control">
                                            <option value="prive">Privé</option>
                                            <option value="holding">Holding</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="vennootschapsbelasting">Vennootschapsbelasting (%):</label>
                                        <input type="number" id="vennootschapsbelasting" value="19.8" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="waardestijging">Waardestijging (% per jaar):</label>
                                        <input type="number" id="waardestijging" value="5" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Holding Instellingen -->
                        <div id="holdingInstellingen" class="settings-section" style="display: none;">
                            <h3>Holding Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="rentePrive">Rente prive (%):</label>
                                        <input type="number" id="rentePrive" value="5" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resultaten Panel -->
                <div class="results-panel">
                    <!-- Scenario Resultaten -->
                    <div id="scenarioResultaten" class="card">
                        <h2>Scenario Resultaten</h2>
                        
                        <!-- Scenario Diagrammen -->
                        <div class="charts-grid">
                            <!-- ROE Chart -->
                            <div class="chart-container">
                                <canvas id="roeChart"></canvas>
                            </div>

                            <!-- Netto Maandinkomen Chart -->
                            <div class="chart-container">
                                <canvas id="maandinkomenChart"></canvas>
                            </div>
                        </div>

                        <!-- Scenario Tabel -->
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Huur %</th>
                                        <th>Kosten %</th>
                                        <th>Huur €</th>
                                        <th>Hypo €</th>
                                        <th>Onderh €</th>
                                        <th>Rente EV €</th>
                                        <th>Vpb €</th>
                                        <th>Netto €</th>
                                        <th>Netto/mnd €</th>
                                        <th>Waarde €</th>
                                        <th>ROE %</th>
                                        <th>ROE+ %</th>
                                    </tr>
                                </thead>
                                <tbody id="scenarioTabel">
                                    <!-- Hier komen de scenario rijen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Groeiprojectie Tab content -->
        <div id="groeiprojectieTab" class="tab-content">
            <div class="card">
                <h2>Vastgoed Groeiprojectie</h2>

                <!-- Basis Instellingen -->
                <div class="settings-section">
                    <h3>Basis Instellingen</h3>
                    <div class="grid">
                        <div class="grid-col-2">
                            <div class="form-group">
                                <label for="eigenVermogen">Eigen vermogen (€):</label>
                                <input type="number" id="eigenVermogen" value="500000" step="10000">
                            </div>

                            <div class="form-group">
                                <label for="ltv">Loan-to-Value (%):</label>
                                <input type="number" id="ltv" value="75" min="0" max="100">
                            </div>

                            <div class="form-group">
                                <label for="gewenstNettoInkomen">Gewenst netto maandinkomen (€):</label>
                                <input type="number" id="gewenstNettoInkomen" value="5000" step="100">
                            </div>
                    </div>

                    <div class="grid-col-2">
                        <div class="form-group">
                            <label for="huurRendement">Bruto huurrendement (%):</label>
                            <input type="number" id="huurRendement" value="6" step="0.1" min="0">
                        </div>

                        <div class="form-group">
                            <label for="kostenPercentage">Kosten (% van woningwaarde per jaar):</label>
                            <input type="number" id="kostenPercentage" value="1.5" step="0.1" min="0">
                        </div>

                        <div class="form-group">
                            <label for="waardestijgingPercentage">Waardestijging (% per jaar):</label>
                            <input type="number" id="waardestijgingPercentage" value="5" step="0.1" min="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Geavanceerde Instellingen -->
                <div class="settings-section">
                    <h3>Geavanceerde Instellingen</h3>
                <div class="grid">
                    <div class="grid-col-2">
                        <div class="form-group">
                                <label for="rentePercentage">Hypotheekrente (%):</label>
                                <input type="number" id="rentePercentage" value="5" step="0.1" min="0">
                            </div>

                            <div class="form-group">
                                <label for="belastingPercentage">Belasting percentage (%):</label>
                                <input type="number" id="belastingPercentage" value="30" step="1" min="0" max="100">
                            </div>

                            <div class="form-group">
                                <label for="inflatiePercentage">Inflatie (% per jaar):</label>
                                <input type="number" id="inflatiePercentage" value="2" step="0.1" min="0">
                        </div>
                    </div>

                    <div class="grid-col-2">
                            <div class="form-group">
                                <label for="herinvesteringsPercentage">Herinvesteringspercentage (%):</label>
                                <input type="number" id="herinvesteringsPercentage" value="100" step="10" min="0" max="100">
                            </div>

                            <div class="form-group">
                                <label for="maxLtvPercentage">Maximale LTV voor nieuwe investeringen (%):</label>
                                <input type="number" id="maxLtvPercentage" value="75" step="5" min="0" max="100">
                            </div>

                            <div class="form-group">
                                <label for="minCashflowReserve">Minimale cashflow reserve (maanden):</label>
                                <input type="number" id="minCashflowReserve" value="6" step="1" min="0">
                            </div>
                        </div>
                    </div>

                    <div class="checkbox-group">
                            <div class="checkbox-container">
                                <input type="checkbox" id="herinvesteerWaardestijging" checked>
                                <label for="herinvesteerWaardestijging">Herinvesteer waardestijging</label>
                            </div>

                            <div class="checkbox-container">
                                <input type="checkbox" id="herinvesteerCashflow">
                                <label for="herinvesteerCashflow">Herinvesteer cashflow</label>
                            </div>

                        <div class="checkbox-container">
                            <input type="checkbox" id="rekeningMetInflatie" checked>
                            <label for="rekeningMetInflatie">Rekening houden met inflatie</label>
                        </div>

                        <div class="checkbox-container">
                            <input type="checkbox" id="rekeningMetBelasting" checked>
                            <label for="rekeningMetBelasting">Rekening houden met belasting</label>
                        </div>
                    </div>
                </div>

                <button id="berekenGroei" class="button" style="margin-top: 20px;">Bereken groeiprojectie</button>
            </div>

            <!-- Groeiprojectie Resultaten -->
            <div id="groeiResultaten" class="card" style="display: none;">
                <h2>Groeiprojectie Resultaten</h2>

                <div class="resultaat-blok">
                    <div class="grid">
                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">Startinvestering:</span>
                                <span id="totaleInvestering">€ 2,000,000</span>
                            </div>
                        </div>

                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">Start eigen vermogen:</span>
                                <span id="eigenVermogenStart">€ 500,000</span>
                            </div>
                        </div>

                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">Jaarlijkse cashflow (start):</span>
                                <span id="jaarlijkseCashflowStart">€ 15,000</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">Jaren tot doel:</span>
                                <span id="jarenTotDoel">12 jaren</span>
                            </div>
                        </div>

                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">Investering bij doel:</span>
                                <span id="investeringBijDoel">€ 6,230,450</span>
                            </div>
                        </div>

                        <div class="grid-col-3">
                            <div class="resultaat-rij">
                                <span class="resultaat-label">EV bij doel:</span>
                                <span id="evBijDoel">€ 1,557,613</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grafiek container -->
                <div class="chart-container" id="groeigrafiek">
                    <!-- Hier komt de grafiek -->
                </div>

                <div class="legenda">
                    <div class="legenda-item">
                        <div class="legenda-kleur" style="background-color: #3182ce;"></div>
                        <span>Totale investering</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-kleur" style="background-color: #48bb78;"></div>
                        <span>Eigen vermogen</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-kleur" style="background-color: #f6ad55;"></div>
                        <span>Jaarlijkse cashflow</span>
                    </div>
                </div>

                <!-- Tabel met gedetailleerde resultaten -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Jaar</th>
                                <th>Totale investering</th>
                                <th>Eigen vermogen</th>
                                <th>Schuld</th>
                                <th>Jaarlijkse cashflow</th>
                                <th>Waardestijging</th>
                                <th>Herinvestering</th>
                                <th>LTV ratio (%)</th>
                                <th>ROE (%)</th>
                                <th>Doelbereikt</th>
                            </tr>
                        </thead>
                        <tbody id="groeiTabel">
                            <!-- Hier komen de rijen -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Formules en berekeningen -->
            <div class="card">
                <h2>Formules en Berekeningen</h2>

                <div class="formules-sectie">
                    <div class="formule-item">
                        <div class="formule-naam">Totale investering</div>
                        <div class="formule-beschrijving">De totale vastgoedinvestering berekend op basis van eigen
                            vermogen en LTV</div>
                        <div class="formule-code">totaleInvestering = eigenVermogen / (1 - ltv / 100)</div>
                        <div>Voorbeeld: € 500.000 / (1 - 75% / 100) = € 2.000.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Hypotheek</div>
                        <div class="formule-beschrijving">Het geleende bedrag</div>
                        <div class="formule-code">hypotheek = totaleInvestering - eigenVermogen</div>
                        <div>Voorbeeld: € 2.000.000 - € 500.000 = € 1.500.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Jaarlijkse huurinkomsten</div>
                        <div class="formule-beschrijving">De totale huuropbrengst per jaar</div>
                        <div class="formule-code">jaarlijkseHuurInkomsten = totaleInvestering * (huurRendement / 100)
                        </div>
                        <div>Voorbeeld: € 2.000.000 * (6% / 100) = € 120.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Jaarlijkse rentekosten</div>
                        <div class="formule-beschrijving">De jaarlijkse kosten voor de hypotheek (alleen rente)</div>
                        <div class="formule-code">jaarlijkseRente = hypotheek * (rentePercentage / 100)</div>
                        <div>Voorbeeld: € 1.500.000 * (5% / 100) = € 75.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Jaarlijkse onderhoudskosten</div>
                        <div class="formule-beschrijving">De jaarlijkse kosten voor onderhoud, belastingen, etc.</div>
                        <div class="formule-code">jaarlijkseKosten = totaleInvestering * (kostenPercentage / 100)</div>
                        <div>Voorbeeld: € 2.000.000 * (1.5% / 100) = € 30.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Jaarlijkse cashflow</div>
                        <div class="formule-beschrijving">De netto-inkomsten per jaar</div>
                        <div class="formule-code">jaarlijkseCashflow = jaarlijkseHuurInkomsten - jaarlijkseRente -
                            jaarlijkseKosten</div>
                        <div>Voorbeeld: € 120.000 - € 75.000 - € 30.000 = € 15.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Jaarlijkse waardestijging</div>
                        <div class="formule-beschrijving">De verwachte waardevermeerdering van het vastgoed per jaar
                        </div>
                        <div class="formule-code">jaarlijkseWaardestijging = totaleInvestering *
                            (waardestijgingPercentage / 100)</div>
                        <div>Voorbeeld: € 2.000.000 * (5% / 100) = € 100.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Herinvestering</div>
                        <div class="formule-beschrijving">Het bedrag dat wordt hergebruikt voor nieuwe investeringen
                        </div>
                        <div class="formule-code">herinvesterenBedrag = (herinvesteerWaardestijging ? waardestijging :
                            0) + (herinvesteerCashflow ? cashflow : 0)</div>
                        <div>Voorbeeld: (true ? € 100.000 : 0) + (false ? € 15.000 : 0) = € 100.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Nieuwe hypotheek</div>
                        <div class="formule-beschrijving">De extra hypotheek die kan worden aangetrokken bij
                            herinvestering</div>
                        <div class="formule-code">nieuweHypotheek = herinvesterenBedrag * (ltv / (100 - ltv))</div>
                        <div>Voorbeeld: € 100.000 * (75 / (100 - 75)) = € 300.000</div>
                    </div>

                    <div class="formule-item">
                        <div class="formule-naam">Rendement op eigen vermogen (ROE)</div>
                        <div class="formule-beschrijving">Het netto rendement als percentage van het eigen vermogen
                        </div>
                        <div class="formule-code">roe = (cashflow / eigenVermogen) * 100</div>
                        <div>Voorbeeld: (€ 15.000 / € 500.000) * 100 = 3%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vermogensdoel Tab content -->
        <div id="vermogensdoelTab" class="tab-content">
            <div class="main-layout">
                <!-- Instellingen Panel -->
                <div class="settings-panel">
                    <div class="card">
                        <h2>Instellingen</h2>

                        <!-- Basis Instellingen -->
                        <div class="settings-section">
                            <h3>Basis Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="gewenstInkomen">Gewenst netto maandinkomen (€):</label>
                                        <input type="number" id="gewenstInkomen" value="5000" step="100">
    </div>

                                    <div class="form-group">
                                        <label for="inkomenStijging">Jaarlijkse stijging gewenst inkomen (%):</label>
                                        <input type="number" id="inkomenStijging" value="3" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="looptijd">Looptijd berekening (jaren):</label>
                                        <input type="number" id="looptijd" value="30" step="1" min="1">
                                    </div>

                                    <div class="form-group">
                                        <label for="structuurVermogensdoel">Structuur:</label>
                                        <select id="structuurVermogensdoel" class="form-control">
                                            <option value="prive">Privé</option>
                                            <option value="holding">Holding</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="ltvVermogensdoel">Loan-to-Value (%):</label>
                                        <input type="number" id="ltvVermogensdoel" value="75" min="0" max="100">
                                    </div>

                                    <div class="form-group">
                                        <label for="rentePercentageVermogensdoel">Hypotheekrente (%):</label>
                                        <input type="number" id="rentePercentageVermogensdoel" value="5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="huurrendementVermogensdoel">Huurrendement (%):</label>
                                        <input type="number" id="huurrendementVermogensdoel" value="6" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="huurstijging">Jaarlijkse huurstijging (%):</label>
                                        <input type="number" id="huurstijging" value="2" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="kostenPercentageVermogensdoel">Kosten percentage (%):</label>
                                        <input type="number" id="kostenPercentageVermogensdoel" value="1.5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="waardestijgingVermogensdoel">Waardestijging vastgoed (%):</label>
                                        <input type="number" id="waardestijgingVermogensdoel" value="5" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Herinvesteringsopties -->
                        <div class="settings-section">
                            <h3>Herinvesteringsopties</h3>
                            <div class="checkbox-group">
                                <div class="checkbox-container">
                                    <input type="checkbox" id="herinvesteerCashflowVermogensdoel" checked>
                                    <label for="herinvesteerCashflowVermogensdoel">Herinvesteer cashflow</label>
                                </div>

                                <div class="checkbox-container">
                                    <input type="checkbox" id="herinvesteerWaardestijgingVermogensdoel" checked>
                                    <label for="herinvesteerWaardestijgingVermogensdoel">Herinvesteer waardestijging</label>
                                </div>
                            </div>
                        </div>

                        <!-- Holding Instellingen -->
                        <div id="holdingInstellingenVermogensdoel" class="settings-section" style="display: none;">
                            <h3>Holding Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="rentePriveVermogensdoel">Rente prive (%):</label>
                                        <input type="number" id="rentePriveVermogensdoel" value="5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="vennootschapsbelastingVermogensdoel">Vennootschapsbelasting (%):</label>
                                        <input type="number" id="vennootschapsbelastingVermogensdoel" value="19.8" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resultaten Panel -->
                <div class="results-panel">
                    <!-- Vermogensdoel Resultaten -->
                    <div id="vermogensdoelResultaten" class="card">
                        <h2>Vermogensdoel Resultaten</h2>
                        
                        <!-- Samenvatting -->
                        <div class="resultaat-blok">
                            <div class="grid">
                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Benodigd eigen vermogen:</span>
                                        <span id="benodigdEigenVermogen">€ 0</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Totale vastgoedwaarde:</span>
                                        <span id="totaleVastgoedwaarde">€ 0</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Aantal woningen:</span>
                                        <span id="aantalWoningen">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Diagrammen -->
                        <div class="charts-grid">
                            <!-- Inkomensprojectie Chart -->
                            <div class="chart-container">
                                <canvas id="inkomensprojectieChart"></canvas>
                            </div>

                            <!-- Portfolio Groei Chart -->
                            <div class="chart-container">
                                <canvas id="portfolioGroeiChart"></canvas>
                            </div>
                        </div>

                        <!-- Gedetailleerde Projectie -->
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Jaar</th>
                                        <th>Gewenst inkomen</th>
                                        <th>Gegenereerd inkomen</th>
                                        <th>Portfolio waarde</th>
                                        <th>Eigen vermogen</th>
                                        <th>Extra EV nodig</th>
                                    </tr>
                                </thead>
                                <tbody id="vermogensdoelTabel">
                                    <!-- Hier komen de projectie rijen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vermogensgroei & Inkomen Tab content -->
        <div id="vermogensgroeiTab" class="tab-content">
            <div class="main-layout">
                <!-- Instellingen Panel -->
                <div class="settings-panel">
                    <div class="card">
                        <h2>Instellingen</h2>

                        <!-- Basis Instellingen -->
                        <div class="settings-section">
                            <h3>Basis Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="startEigenVermogen">Start eigen vermogen (€):</label>
                                        <input type="number" id="startEigenVermogen" value="500000" step="10000">
                                    </div>

                                    <div class="form-group">
                                        <label for="pandwaarde">Gemiddelde pandwaarde (€):</label>
                                        <input type="number" id="pandwaarde" value="350000" step="10000">
                                    </div>

                                    <div class="form-group">
                                        <label for="looptijdVermogensgroei">Looptijd berekening (jaren):</label>
                                        <input type="number" id="looptijdVermogensgroei" value="30" step="1" min="1">
                                    </div>

                                    <div class="form-group">
                                        <label for="structuurVermogensgroei">Structuur:</label>
                                        <select id="structuurVermogensgroei" class="form-control">
                                            <option value="prive">Privé</option>
                                            <option value="holding">Holding</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="ltvVermogensgroei">Loan-to-Value (%):</label>
                                        <input type="number" id="ltvVermogensgroei" value="75" min="0" max="100">
                                    </div>

                                    <div class="form-group">
                                        <label for="rentePercentageVermogensgroei">Hypotheekrente (%):</label>
                                        <input type="number" id="rentePercentageVermogensgroei" value="5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="huurrendementVermogensgroei">Huurrendement (%):</label>
                                        <input type="number" id="huurrendementVermogensgroei" value="6" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="huurstijgingVermogensgroei">Jaarlijkse huurstijging (%):</label>
                                        <input type="number" id="huurstijgingVermogensgroei" value="2" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="kostenPercentageVermogensgroei">Kosten percentage (%):</label>
                                        <input type="number" id="kostenPercentageVermogensgroei" value="1.5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="waardestijgingVermogensgroei">Waardestijging vastgoed (%):</label>
                                        <input type="number" id="waardestijgingVermogensgroei" value="5" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Strategie Instellingen -->
                        <div class="settings-section">
                            <h3>Strategie Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="minimaalInkomen">Minimaal inkomen per maand (€):</label>
                                        <input type="number" id="minimaalInkomen" value="5000" step="100">
                                    </div>

                                    <div class="form-group">
                                        <label for="minimaalInkomenInflatie">Jaarlijkse stijging minimaal inkomen (%):</label>
                                        <input type="number" id="minimaalInkomenInflatie" value="2" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="inkomenHerinvestering">Herinvestering cashflow (%):</label>
                                        <input type="range" id="inkomenHerinvestering" class="slider" min="0" max="100" value="50">
                                        <span id="inkomenHerinvesteringValue">50%</span>
                                    </div>

                                    <div class="checkbox-container">
                                        <input type="checkbox" id="herinvesteerWaardestijgingVermogensgroei" checked>
                                        <label for="herinvesteerWaardestijgingVermogensgroei">Herinvesteer waardestijging</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Comfortniveaus -->
                        <div class="settings-section">
                            <h3>Comfortniveaus</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="comfortNiveau1">Comfortniveau 1 (€/mnd):</label>
                                        <input type="number" id="comfortNiveau1" value="5000" step="100">
                                    </div>

                                    <div class="form-group">
                                        <label for="comfortNiveau2">Comfortniveau 2 (€/mnd):</label>
                                        <input type="number" id="comfortNiveau2" value="10000" step="100">
                                    </div>

                                    <div class="form-group">
                                        <label for="comfortNiveau3">Comfortniveau 3 (€/mnd):</label>
                                        <input type="number" id="comfortNiveau3" value="20000" step="100">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Holding Instellingen -->
                        <div id="holdingInstellingenVermogensgroei" class="settings-section" style="display: none;">
                            <h3>Holding Instellingen</h3>
                            <div class="grid">
                                <div class="grid-col-1">
                                    <div class="form-group">
                                        <label for="rentePriveVermogensgroei">Rente prive (%):</label>
                                        <input type="number" id="rentePriveVermogensgroei" value="5" step="0.1" min="0">
                                    </div>

                                    <div class="form-group">
                                        <label for="vennootschapsbelastingVermogensgroei">Vennootschapsbelasting (%):</label>
                                        <input type="number" id="vennootschapsbelastingVermogensgroei" value="19.8" step="0.1" min="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resultaten Panel -->
                <div class="results-panel">
                    <!-- Vermogensgroei Resultaten -->
                    <div id="vermogensgroeiResultaten" class="card">
                        <h2>Vermogensgroei & Inkomen Resultaten</h2>
                        
                        <!-- Samenvatting -->
                        <div class="resultaat-blok">
                            <div class="grid">
                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Totale vastgoedwaarde:</span>
                                        <span id="totaleVastgoedwaardeVermogensgroei">€ 0</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Aantal woningen:</span>
                                        <span id="aantalWoningenVermogensgroei">0</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Initieel netto inkomen:</span>
                                        <span id="initieelNettoInkomen">€ 0</span>
                                    </div>
                                </div>
                            </div>

                            <div class="grid">
                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Break-even punt:</span>
                                        <span id="breakEvenPunt">-</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Rendement per €100k EV:</span>
                                        <span id="rendementPer100k">€ 0 (0%)</span>
                                    </div>
                                </div>

                                <div class="grid-col-3">
                                    <div class="resultaat-rij">
                                        <span class="resultaat-label">Totale portfolio waarde:</span>
                                        <span id="totalePortfolioWaarde">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Comfortniveaus -->
                        <div class="comfort-niveaus">
                            <h3>Comfortniveaus</h3>
                            <div class="comfort-grid">
                                <div class="comfort-item">
                                    <span class="comfort-label">Comfortniveau 1</span>
                                    <span id="comfortNiveau1Jaar">-</span>
                                </div>
                                <div class="comfort-item">
                                    <span class="comfort-label">Comfortniveau 2</span>
                                    <span id="comfortNiveau2Jaar">-</span>
                                </div>
                                <div class="comfort-item">
                                    <span class="comfort-label">Comfortniveau 3</span>
                                    <span id="comfortNiveau3Jaar">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Diagrammen -->
                        <div class="charts-grid">
                            <!-- Vermogensgroei Chart -->
                            <div class="chart-container">
                                <canvas id="vermogensgroeiChart"></canvas>
                            </div>

                            <!-- Inkomen Chart -->
                            <div class="chart-container">
                                <canvas id="inkomenChart"></canvas>
                            </div>
                        </div>

                        <!-- Gedetailleerde Projectie -->
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Jaar</th>
                                        <th>Vastgoedwaarde</th>
                                        <th>Netto inkomen p/m</th>
                                        <th>Eigen vermogen</th>
                                        <th>EV stijging</th>
                                        <th>Aantal panden</th>
                                        <th>ROE %</th>
                                    </tr>
                                </thead>
                                <tbody id="vermogensgroeiTabel">
                                    <!-- Hier komen de projectie rijen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart instances
        let roeChart = null;
        let maandinkomenChart = null;
        let vermogensgroeiChart = null;
        let inkomenChart = null;

        function berekenScenarioResultaten() {
            const eigenVermogen = parseFloat(document.getElementById('eigenVermogen').value);
            const ltv = parseFloat(document.getElementById('ltv').value) / 100;
            const rentePercentage = parseFloat(document.getElementById('rentePercentage').value) / 100;
            const vennootschapsbelasting = parseFloat(document.getElementById('vennootschapsbelasting').value) / 100;
            const rentePrive = parseFloat(document.getElementById('rentePrive').value) / 100;
            const isHolding = document.getElementById('structuur').value === 'holding';
            const waardestijging = parseFloat(document.getElementById('waardestijging').value) / 100;

            // Bereken initiële situatie
            const totaleVastgoedwaarde = eigenVermogen / (1 - ltv);
            const hypotheek = totaleVastgoedwaarde - eigenVermogen;
            const aantalWoningen = Math.ceil(totaleVastgoedwaarde / 400000);

            // Bereken verschillende scenario's
            const scenarios = [];
            const huurRendementen = [4, 5, 6, 7, 8];
            const kostenPercentages = [1, 1.5, 2];

            huurRendementen.forEach(huurRendement => {
                kostenPercentages.forEach(kostenPercentage => {
                    const huurInkomsten = totaleVastgoedwaarde * (huurRendement / 100);
                    const hypotheekRente = hypotheek * rentePercentage;
                    const onderhoudskosten = totaleVastgoedwaarde * (kostenPercentage / 100);
                    let nettoInkomen;

                    if (isHolding) {
                        const vennootschapsbelastingBedrag = rentePrive * vennootschapsbelasting;
                        nettoInkomen = huurInkomsten - hypotheekRente - onderhoudskosten - vennootschapsbelastingBedrag;
                    } else {
                        nettoInkomen = huurInkomsten - hypotheekRente - onderhoudskosten;
                    }

                    const roe = (nettoInkomen / eigenVermogen) * 100;
                    const roePlusWaardestijging = roe + (waardestijging * 100);

                    scenarios.push({
                        huurRendement,
                        kostenPercentage,
                        huurInkomsten,
                        hypotheekRente,
                        onderhoudskosten,
                        rentePrive,
                        vennootschapsbelasting: isHolding ? rentePrive * vennootschapsbelasting : 0,
                        nettoInkomen,
                        nettoInkomenPerMaand: nettoInkomen / 12,
                        vastgoedwaarde: totaleVastgoedwaarde,
                        roe,
                        roePlusWaardestijging
                    });
                });
            });

            return scenarios;
        }

        function updateCharts(scenarios) {
            // Update ROE Chart
            const roeCtx = document.getElementById('roeChart').getContext('2d');
            if (roeChart) {
                roeChart.destroy();
            }
            roeChart = new Chart(roeCtx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => `${s.huurRendement}% huur`),
                    datasets: [
                        {
                            label: 'ROE',
                            data: scenarios.map(s => s.roe),
                            backgroundColor: '#3182ce'
                        },
                        {
                            label: 'ROE + Waardestijging',
                            data: scenarios.map(s => s.roePlusWaardestijging),
                            backgroundColor: '#48bb78'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Rendement (%)'
                            }
                        }
                    }
                }
            });

            // Update Maandinkomen Chart
            const maandinkomenCtx = document.getElementById('maandinkomenChart').getContext('2d');
            if (maandinkomenChart) {
                maandinkomenChart.destroy();
            }
            maandinkomenChart = new Chart(maandinkomenCtx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => `${s.huurRendement}% huur`),
                    datasets: [
                        {
                            label: 'Netto Maandinkomen',
                            data: scenarios.map(s => s.nettoInkomenPerMaand),
                            backgroundColor: '#f6ad55'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Netto Maandinkomen (€)'
                            }
                        }
                    }
                }
            });
        }

        function updateScenarioTabel(scenarios) {
            const tbody = document.getElementById('scenarioTabel');
            tbody.innerHTML = '';

            scenarios.forEach(scenario => {
                const row = document.createElement('tr');
                    row.innerHTML = `
                    <td>${scenario.huurRendement}%</td>
                    <td>${scenario.kostenPercentage}%</td>
                    <td>${formatBedrag(scenario.huurInkomsten)}</td>
                    <td>${formatBedrag(scenario.hypotheekRente)}</td>
                    <td>${formatBedrag(scenario.onderhoudskosten)}</td>
                    <td>${formatBedrag(scenario.rentePrive)}</td>
                    <td>${formatBedrag(scenario.vennootschapsbelasting)}</td>
                    <td>${formatBedrag(scenario.nettoInkomen)}</td>
                    <td>${formatBedrag(scenario.nettoInkomenPerMaand)}</td>
                    <td>${formatBedrag(scenario.vastgoedwaarde)}</td>
                    <td>${scenario.roe.toFixed(1)}%</td>
                    <td>${scenario.roePlusWaardestijging.toFixed(1)}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Input elementen selecteren
            const eigenVermogenInput = document.getElementById('eigenVermogen');
            const ltvInput = document.getElementById('ltv');
            const rentePercentageInput = document.getElementById('rentePercentage');
            const vennootschapsbelastingInput = document.getElementById('vennootschapsbelasting');
            const rentePriveInput = document.getElementById('rentePrive');
            const structuurSelect = document.getElementById('structuur');
            const holdingInstellingen = document.getElementById('holdingInstellingen');

            // Vermogensgroei input elementen
            const startEigenVermogenInput = document.getElementById('startEigenVermogen');
            const pandwaardeInput = document.getElementById('pandwaarde');
            const looptijdVermogensgroeiInput = document.getElementById('looptijdVermogensgroei');
            const structuurVermogensgroeiSelect = document.getElementById('structuurVermogensgroei');
            const holdingInstellingenVermogensgroei = document.getElementById('holdingInstellingenVermogensgroei');
            const ltvVermogensgroeiInput = document.getElementById('ltvVermogensgroei');
            const rentePercentageVermogensgroeiInput = document.getElementById('rentePercentageVermogensgroei');
            const huurrendementVermogensgroeiInput = document.getElementById('huurrendementVermogensgroei');
            const huurstijgingVermogensgroeiInput = document.getElementById('huurstijgingVermogensgroei');
            const kostenPercentageVermogensgroeiInput = document.getElementById('kostenPercentageVermogensgroei');
            const waardestijgingVermogensgroeiInput = document.getElementById('waardestijgingVermogensgroei');
            const inkomenHerinvesteringInput = document.getElementById('inkomenHerinvestering');
            const inkomenHerinvesteringValue = document.getElementById('inkomenHerinvesteringValue');
            const herinvesteerWaardestijgingVermogensgroeiInput = document.getElementById('herinvesteerWaardestijgingVermogensgroei');
            const comfortNiveau1Input = document.getElementById('comfortNiveau1');
            const comfortNiveau2Input = document.getElementById('comfortNiveau2');
            const comfortNiveau3Input = document.getElementById('comfortNiveau3');
            const rentePriveVermogensgroeiInput = document.getElementById('rentePriveVermogensgroei');
            const vennootschapsbelastingVermogensgroeiInput = document.getElementById('vennootschapsbelastingVermogensgroei');
            const minimaalInkomenInput = document.getElementById('minimaalInkomen');
            const minimaalInkomenInflatieInput = document.getElementById('minimaalInkomenInflatie');

            // Laad opgeslagen waarden voor scenario tab
            const scenarioWaarden = JSON.parse(localStorage.getItem('scenarioWaarden') || '{}');
            if (scenarioWaarden.eigenVermogen) eigenVermogenInput.value = scenarioWaarden.eigenVermogen;
            if (scenarioWaarden.ltv) ltvInput.value = scenarioWaarden.ltv;
            if (scenarioWaarden.rentePercentage) rentePercentageInput.value = scenarioWaarden.rentePercentage;
            if (scenarioWaarden.vennootschapsbelasting) vennootschapsbelastingInput.value = scenarioWaarden.vennootschapsbelasting;
            if (scenarioWaarden.rentePrive) rentePriveInput.value = scenarioWaarden.rentePrive;
            if (scenarioWaarden.structuur) structuurSelect.value = scenarioWaarden.structuur;
            if (scenarioWaarden.waardestijging) document.getElementById('waardestijging').value = scenarioWaarden.waardestijging;

            // Laad opgeslagen waarden voor vermogensgroei tab
            const vermogensgroeiWaarden = JSON.parse(localStorage.getItem('vermogensgroeiWaarden') || '{}');
            if (vermogensgroeiWaarden.startEigenVermogen) startEigenVermogenInput.value = vermogensgroeiWaarden.startEigenVermogen;
            if (vermogensgroeiWaarden.pandwaarde) pandwaardeInput.value = vermogensgroeiWaarden.pandwaarde;
            if (vermogensgroeiWaarden.looptijd) looptijdVermogensgroeiInput.value = vermogensgroeiWaarden.looptijd;
            if (vermogensgroeiWaarden.structuur) structuurVermogensgroeiSelect.value = vermogensgroeiWaarden.structuur;
            if (vermogensgroeiWaarden.ltv) ltvVermogensgroeiInput.value = vermogensgroeiWaarden.ltv;
            if (vermogensgroeiWaarden.rentePercentage) rentePercentageVermogensgroeiInput.value = vermogensgroeiWaarden.rentePercentage;
            if (vermogensgroeiWaarden.huurrendement) huurrendementVermogensgroeiInput.value = vermogensgroeiWaarden.huurrendement;
            if (vermogensgroeiWaarden.huurstijging) huurstijgingVermogensgroeiInput.value = vermogensgroeiWaarden.huurstijging;
            if (vermogensgroeiWaarden.kostenPercentage) kostenPercentageVermogensgroeiInput.value = vermogensgroeiWaarden.kostenPercentage;
            if (vermogensgroeiWaarden.waardestijging) waardestijgingVermogensgroeiInput.value = vermogensgroeiWaarden.waardestijging;
            if (vermogensgroeiWaarden.inkomenHerinvestering) {
                inkomenHerinvesteringInput.value = vermogensgroeiWaarden.inkomenHerinvestering;
                inkomenHerinvesteringValue.textContent = `${vermogensgroeiWaarden.inkomenHerinvestering}%`;
            }
            if (vermogensgroeiWaarden.herinvesteerWaardestijging !== undefined) {
                herinvesteerWaardestijgingVermogensgroeiInput.checked = vermogensgroeiWaarden.herinvesteerWaardestijging;
            }
            if (vermogensgroeiWaarden.comfortNiveau1) comfortNiveau1Input.value = vermogensgroeiWaarden.comfortNiveau1;
            if (vermogensgroeiWaarden.comfortNiveau2) comfortNiveau2Input.value = vermogensgroeiWaarden.comfortNiveau2;
            if (vermogensgroeiWaarden.comfortNiveau3) comfortNiveau3Input.value = vermogensgroeiWaarden.comfortNiveau3;
            if (vermogensgroeiWaarden.rentePrive) rentePriveVermogensgroeiInput.value = vermogensgroeiWaarden.rentePrive;
            if (vermogensgroeiWaarden.vennootschapsbelasting) vennootschapsbelastingVermogensgroeiInput.value = vermogensgroeiWaarden.vennootschapsbelasting;
            if (vermogensgroeiWaarden.minimaalInkomen) minimaalInkomenInput.value = vermogensgroeiWaarden.minimaalInkomen;
            if (vermogensgroeiWaarden.minimaalInkomenInflatie) minimaalInkomenInflatieInput.value = vermogensgroeiWaarden.minimaalInkomenInflatie;

            // Laad laatste actieve tab
            const laatsteTab = localStorage.getItem('laatsteTab') || 'scenario';
            document.querySelectorAll('.tab-button').forEach(button => {
                if (button.dataset.tab === laatsteTab) {
                    button.classList.add('active');
                    document.getElementById(`${button.dataset.tab}Tab`).classList.add('active');
                } else {
                    button.classList.remove('active');
                    document.getElementById(`${button.dataset.tab}Tab`).classList.remove('active');
                }
            });

            // Initialiseer holding instellingen
            holdingInstellingen.style.display = 'none';
            holdingInstellingenVermogensgroei.style.display = 'none';

            // Tab navigatie
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    button.classList.add('active');
                    document.getElementById(`${button.dataset.tab}Tab`).classList.add('active');
                    localStorage.setItem('laatsteTab', button.dataset.tab);
                });
            });

            // Event listeners voor scenario inputs
            [eigenVermogenInput, ltvInput, rentePercentageInput, vennootschapsbelastingInput, rentePriveInput, document.getElementById('waardestijging')].forEach(input => {
                input.addEventListener('input', () => {
                    const resultaten = berekenScenarioResultaten();
                    updateCharts(resultaten);
                    updateScenarioTabel(resultaten);
                    localStorage.setItem('scenarioWaarden', JSON.stringify({
                        eigenVermogen: eigenVermogenInput.value,
                        ltv: ltvInput.value,
                        rentePercentage: rentePercentageInput.value,
                        vennootschapsbelasting: vennootschapsbelastingInput.value,
                        rentePrive: rentePriveInput.value,
                        structuur: structuurSelect.value,
                        waardestijging: document.getElementById('waardestijging').value
                    }));
                });
            });

            // Event listeners voor vermogensgroei inputs
            [startEigenVermogenInput, pandwaardeInput, looptijdVermogensgroeiInput,
             ltvVermogensgroeiInput, rentePercentageVermogensgroeiInput, huurrendementVermogensgroeiInput,
             huurstijgingVermogensgroeiInput, kostenPercentageVermogensgroeiInput, waardestijgingVermogensgroeiInput,
             herinvesteerWaardestijgingVermogensgroeiInput, comfortNiveau1Input, comfortNiveau2Input,
             comfortNiveau3Input, rentePriveVermogensgroeiInput, vennootschapsbelastingVermogensgroeiInput,
             minimaalInkomenInput, minimaalInkomenInflatieInput].forEach(input => {
                input.addEventListener('input', () => {
                    berekenVermogensgroei();
                    localStorage.setItem('vermogensgroeiWaarden', JSON.stringify({
                        startEigenVermogen: startEigenVermogenInput.value,
                        pandwaarde: pandwaardeInput.value,
                        looptijd: looptijdVermogensgroeiInput.value,
                        structuur: structuurVermogensgroeiSelect.value,
                        ltv: ltvVermogensgroeiInput.value,
                        rentePercentage: rentePercentageVermogensgroeiInput.value,
                        huurrendement: huurrendementVermogensgroeiInput.value,
                        huurstijging: huurstijgingVermogensgroeiInput.value,
                        kostenPercentage: kostenPercentageVermogensgroeiInput.value,
                        waardestijging: waardestijgingVermogensgroeiInput.value,
                        inkomenHerinvestering: inkomenHerinvesteringInput.value,
                        herinvesteerWaardestijging: herinvesteerWaardestijgingVermogensgroeiInput.checked,
                        comfortNiveau1: comfortNiveau1Input.value,
                        comfortNiveau2: comfortNiveau2Input.value,
                        comfortNiveau3: comfortNiveau3Input.value,
                        rentePrive: rentePriveVermogensgroeiInput.value,
                        vennootschapsbelasting: vennootschapsbelastingVermogensgroeiInput.value,
                        minimaalInkomen: minimaalInkomenInput.value,
                        minimaalInkomenInflatie: minimaalInkomenInflatieInput.value
                    }));
                });
            });

            // Update slider waarde display
            inkomenHerinvesteringInput.addEventListener('input', () => {
                inkomenHerinvesteringValue.textContent = `${inkomenHerinvesteringInput.value}%`;
                berekenVermogensgroei();
            });

            // Structuur wijziging handlers
            structuurSelect.addEventListener('change', () => {
                holdingInstellingen.style.display = structuurSelect.value === 'holding' ? 'block' : 'none';
                const resultaten = berekenScenarioResultaten();
                updateCharts(resultaten);
                updateScenarioTabel(resultaten);
            });

            structuurVermogensgroeiSelect.addEventListener('change', () => {
                holdingInstellingenVermogensgroei.style.display = structuurVermogensgroeiSelect.value === 'holding' ? 'block' : 'none';
                berekenVermogensgroei();
            });

            // Initialiseer berekeningen
            const resultaten = berekenScenarioResultaten();
            updateCharts(resultaten);
            updateScenarioTabel(resultaten);
            berekenVermogensgroei();
        });

        function berekenVermogensgroei() {
            const startEigenVermogen = parseFloat(document.getElementById('startEigenVermogen').value);
            const pandwaarde = parseFloat(document.getElementById('pandwaarde').value);
            const looptijd = parseInt(document.getElementById('looptijdVermogensgroei').value);
            const isHolding = document.getElementById('structuurVermogensgroei').value === 'holding';
            const ltv = parseFloat(document.getElementById('ltvVermogensgroei').value) / 100;
            const rentePercentage = parseFloat(document.getElementById('rentePercentageVermogensgroei').value) / 100;
            const huurrendement = parseFloat(document.getElementById('huurrendementVermogensgroei').value) / 100;
            const huurstijging = parseFloat(document.getElementById('huurstijgingVermogensgroei').value) / 100;
            const kostenPercentage = parseFloat(document.getElementById('kostenPercentageVermogensgroei').value) / 100;
            const waardestijging = parseFloat(document.getElementById('waardestijgingVermogensgroei').value) / 100;
            const inkomenHerinvesteringPercentage = parseFloat(document.getElementById('inkomenHerinvestering').value) / 100;
            const herinvesteerWaardestijging = document.getElementById('herinvesteerWaardestijgingVermogensgroei').checked;
            const minimaalInkomen = parseFloat(document.getElementById('minimaalInkomen').value);
            const minimaalInkomenInflatie = parseFloat(document.getElementById('minimaalInkomenInflatie').value) / 100;

            // Bereken initiële situatie
            const totaleVastgoedwaarde = startEigenVermogen / (1 - ltv);
            const hypotheek = totaleVastgoedwaarde - startEigenVermogen;
            const aantalWoningen = Math.ceil(totaleVastgoedwaarde / pandwaarde);

            // Bereken initieel netto inkomen
            let initieelNettoInkomen;
            if (isHolding) {
                const rentePrive = parseFloat(document.getElementById('rentePriveVermogensgroei').value) / 100;
                const vennootschapsbelasting = parseFloat(document.getElementById('vennootschapsbelastingVermogensgroei').value) / 100;
                const huurInkomsten = totaleVastgoedwaarde * huurrendement;
                const hypotheekRente = hypotheek * rentePercentage;
                const onderhoudskosten = totaleVastgoedwaarde * kostenPercentage;
                const vennootschapsbelastingBedrag = rentePrive * vennootschapsbelasting;
                initieelNettoInkomen = huurInkomsten - hypotheekRente - onderhoudskosten - vennootschapsbelastingBedrag;
            } else {
                const huurInkomsten = totaleVastgoedwaarde * huurrendement;
                const hypotheekRente = hypotheek * rentePercentage;
                const onderhoudskosten = totaleVastgoedwaarde * kostenPercentage;
                initieelNettoInkomen = huurInkomsten - hypotheekRente - onderhoudskosten;
            }

            // Bereken rendement per 100k eigen vermogen
            const rendementPer100k = (initieelNettoInkomen / startEigenVermogen) * 100000;
            const rendementPercentage = (initieelNettoInkomen / startEigenVermogen) * 100;

            // Bereken projectie per jaar
            const projectie = [];
            let huidigePortfolioWaarde = totaleVastgoedwaarde;
            let huidigEigenVermogen = startEigenVermogen;
            let breakEvenJaar = null;
            let comfortNiveau1Jaar = null;
            let comfortNiveau2Jaar = null;
            let comfortNiveau3Jaar = null;

            for (let jaar = 0; jaar <= looptijd; jaar++) {
                // Bereken inkomen voor dit jaar
                let gegenereerdInkomen;
                if (isHolding) {
                    const rentePrive = parseFloat(document.getElementById('rentePriveVermogensgroei').value) / 100;
                    const vennootschapsbelasting = parseFloat(document.getElementById('vennootschapsbelastingVermogensgroei').value) / 100;
                    const huurInkomsten = huidigePortfolioWaarde * huurrendement * Math.pow(1 + huurstijging, jaar);
                    const hypotheekRente = hypotheek * rentePercentage;
                    const onderhoudskosten = huidigePortfolioWaarde * kostenPercentage * Math.pow(1 + huurstijging, jaar);
                    const vennootschapsbelastingBedrag = rentePrive * vennootschapsbelasting;
                    gegenereerdInkomen = huurInkomsten - hypotheekRente - onderhoudskosten - vennootschapsbelastingBedrag;
                } else {
                    const huurInkomsten = huidigePortfolioWaarde * huurrendement * Math.pow(1 + huurstijging, jaar);
                    const hypotheekRente = hypotheek * rentePercentage;
                    const onderhoudskosten = huidigePortfolioWaarde * kostenPercentage * Math.pow(1 + huurstijging, jaar);
                    gegenereerdInkomen = huurInkomsten - hypotheekRente - onderhoudskosten;
                }

                // Bereken maandelijks inkomen en herinvestering
                const maandelijksInkomen = gegenereerdInkomen / 12;
                const minimaalInkomenDitJaar = minimaalInkomen * Math.pow(1 + minimaalInkomenInflatie, jaar);
                let herinvesterenBedrag = 0;

                // Als het maandelijks inkomen hoger is dan het minimale inkomen
                if (maandelijksInkomen > minimaalInkomenDitJaar) {
                    // Herinvesteer het verschil volgens het percentage
                    herinvesterenBedrag += (maandelijksInkomen - minimaalInkomenDitJaar) * 12 * inkomenHerinvesteringPercentage;
                }

                // Als waardestijging moet worden hergeïnvesteerd
                if (herinvesteerWaardestijging) {
                    herinvesterenBedrag += huidigePortfolioWaarde * waardestijging;
                }

                // Update portfolio
                huidigePortfolioWaarde *= (1 + waardestijging);
                huidigEigenVermogen = huidigePortfolioWaarde * (1 - ltv) + herinvesterenBedrag;

                // Check break-even punt
                if (!breakEvenJaar && gegenereerdInkomen >= startEigenVermogen) {
                    breakEvenJaar = jaar;
                }

                // Check comfortniveaus
                if (!comfortNiveau1Jaar && maandelijksInkomen >= 5000) {
                    comfortNiveau1Jaar = jaar;
                }
                if (!comfortNiveau2Jaar && maandelijksInkomen >= 10000) {
                    comfortNiveau2Jaar = jaar;
                }
                if (!comfortNiveau3Jaar && maandelijksInkomen >= 20000) {
                    comfortNiveau3Jaar = jaar;
                }

                projectie.push({
                    jaar,
                    vastgoedwaarde: huidigePortfolioWaarde,
                    nettoInkomen: Math.min(maandelijksInkomen, minimaalInkomenDitJaar) + 
                                (maandelijksInkomen > minimaalInkomenDitJaar ? 
                                (maandelijksInkomen - minimaalInkomenDitJaar) * (1 - inkomenHerinvesteringPercentage) : 0),
                    eigenVermogen: huidigEigenVermogen,
                    eigenVermogenStijging: jaar > 0 ? huidigEigenVermogen - projectie[jaar-1].eigenVermogen : 0,
                    aantalPanden: Math.ceil(huidigePortfolioWaarde / pandwaarde),
                    roe: (gegenereerdInkomen / huidigEigenVermogen) * 100
                });
            }

            // Update UI
            updateVermogensgroeiUI(
                totaleVastgoedwaarde,
                aantalWoningen,
                initieelNettoInkomen,
                breakEvenJaar,
                projectie,
                comfortNiveau1Jaar,
                comfortNiveau2Jaar,
                comfortNiveau3Jaar,
                rendementPer100k,
                rendementPercentage
            );
        }

        function updateVermogensgroeiUI(
            totaleVastgoedwaarde,
            aantalWoningen,
            initieelNettoInkomen,
            breakEvenJaar,
            projectie,
            comfortNiveau1Jaar,
            comfortNiveau2Jaar,
            comfortNiveau3Jaar,
            rendementPer100k,
            rendementPercentage
        ) {
            // Update samenvatting
            document.getElementById('totaleVastgoedwaardeVermogensgroei').textContent = formatBedrag(totaleVastgoedwaarde);
            document.getElementById('aantalWoningenVermogensgroei').textContent = aantalWoningen;
            document.getElementById('initieelNettoInkomen').textContent = formatBedrag(initieelNettoInkomen);
            document.getElementById('breakEvenPunt').textContent = breakEvenJaar ? `${breakEvenJaar} jaar` : '-';
            document.getElementById('rendementPer100k').textContent = `${formatBedrag(rendementPer100k)} (${rendementPercentage.toFixed(1)}%)`;
            document.getElementById('totalePortfolioWaarde').textContent = formatBedrag(projectie[projectie.length - 1].eigenVermogen);

            // Update comfortniveaus
            document.getElementById('comfortNiveau1Jaar').textContent = comfortNiveau1Jaar ? `${comfortNiveau1Jaar} jaar` : '-';
            document.getElementById('comfortNiveau2Jaar').textContent = comfortNiveau2Jaar ? `${comfortNiveau2Jaar} jaar` : '-';
            document.getElementById('comfortNiveau3Jaar').textContent = comfortNiveau3Jaar ? `${comfortNiveau3Jaar} jaar` : '-';

            // Update tabellen
            updateVermogensgroeiTabel(projectie);

            // Update grafieken
            updateVermogensgroeiGrafieken(projectie);
        }

        function formatBedrag(bedrag) {
            return new Intl.NumberFormat('nl-NL', { 
                style: 'currency', 
                currency: 'EUR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(bedrag);
        }

        function updateVermogensgroeiTabel(projectie) {
            const tbody = document.getElementById('vermogensgroeiTabel');
            tbody.innerHTML = '';
            const minimaalInkomen = parseFloat(document.getElementById('minimaalInkomen').value);
            const minimaalInkomenInflatie = parseFloat(document.getElementById('minimaalInkomenInflatie').value) / 100;

            projectie.forEach(jaar => {
                const minimaalInkomenDitJaar = minimaalInkomen * Math.pow(1 + minimaalInkomenInflatie, jaar.jaar);
                const percentageVanMinimaal = (jaar.nettoInkomen / minimaalInkomenDitJaar) * 100;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${jaar.jaar}</td>
                    <td>${formatBedrag(jaar.vastgoedwaarde)}</td>
                    <td>${formatBedrag(jaar.nettoInkomen)} van ${formatBedrag(minimaalInkomenDitJaar)} (${percentageVanMinimaal.toFixed(1)}%)</td>
                    <td>${formatBedrag(jaar.eigenVermogen)}</td>
                    <td>${formatBedrag(jaar.eigenVermogenStijging)}</td>
                    <td>${jaar.aantalPanden}</td>
                    <td>${jaar.roe.toFixed(1)}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateVermogensgroeiGrafieken(projectie) {
            const minimaalInkomen = parseFloat(document.getElementById('minimaalInkomen').value);
            const minimaalInkomenInflatie = parseFloat(document.getElementById('minimaalInkomenInflatie').value) / 100;

            // Update vermogensgroei grafiek
            if (vermogensgroeiChart) {
                vermogensgroeiChart.destroy();
            }

            const vermogensgroeiCtx = document.getElementById('vermogensgroeiChart').getContext('2d');
            vermogensgroeiChart = new Chart(vermogensgroeiCtx, {
                type: 'line',
                data: {
                    labels: projectie.map(p => p.jaar),
                    datasets: [
                        {
                            label: 'Eigen Vermogen',
                            data: projectie.map(p => p.eigenVermogen),
                            borderColor: '#3182ce',
                            backgroundColor: 'rgba(49, 130, 206, 0.1)',
                            fill: true
                        },
                        {
                            label: 'Vastgoedwaarde',
                            data: projectie.map(p => p.vastgoedwaarde),
                            borderColor: '#48bb78',
                            backgroundColor: 'rgba(72, 187, 120, 0.1)',
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatBedrag(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${formatBedrag(context.raw)}`;
                                }
                            }
                        }
                    }
                }
            });

            // Update inkomen grafiek
            if (inkomenChart) {
                inkomenChart.destroy();
            }

            const inkomenCtx = document.getElementById('inkomenChart').getContext('2d');
            inkomenChart = new Chart(inkomenCtx, {
                type: 'line',
                data: {
                    labels: projectie.map(p => p.jaar),
                    datasets: [
                        {
                            label: 'Netto Inkomen per Maand',
                            data: projectie.map(p => p.nettoInkomen),
                            borderColor: '#f6ad55',
                            backgroundColor: 'rgba(246, 173, 85, 0.1)',
                            fill: true
                        },
                        {
                            label: 'Minimaal Inkomen',
                            data: projectie.map(p => minimaalInkomen * Math.pow(1 + minimaalInkomenInflatie, p.jaar)),
                            borderColor: '#e53e3e',
                            backgroundColor: 'rgba(229, 62, 62, 0.1)',
                            fill: true,
                            borderDash: [5, 5]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Netto Inkomen per Maand (€)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatBedrag(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${formatBedrag(context.raw)}`;
                                }
                            }
                        }
                    }
                    }
                });
            }
    </script>
</body>
</html>